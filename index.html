<html>
    <head>
        <title>COVID-19 en Costa Rica</title>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.5.0/Chart.min.js"></script>
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
        <link href="https://fonts.googleapis.com/css2?family=Quicksand&display=swap" rel="stylesheet">
        <link rel="stylesheet" href="styles.css" />
    </head>
    <body>
        <div id="bienvenida">
            <div id="menu">
                <p>   
                    <a class="menuItem" id="btnGraf2" href="#">Casos Activos</a>
                    <a class="menuItem" id="btnGraf5" href="#">Activos VS Recuperados</a>
                    <a class="menuItem" id="btnGraf1" href="#">Condici&oacuten y Situaci&oacuten Cl&iacutenica</a> 
                    <a class="menuItem" id="btnGraf3" href="#">Cantones con m&aacute;s Recuperados</a>
                    <a class="menuItem" id="btnGraf4" href="#">Alajuela</a>
                    <a class="menuItem" id="btnGrafTodos" href="#">Todos los gr&aacute;ficos</a>
                </p>
            </div>    
        </div>
        <div id="main">
            <div id="container2">   <!-- Casos Activos -->
                <canvas id="linebar-chart"></canvas>
            </div>
            <div id="container5">   <!-- VS -->                 
                <canvas id="line-chart3"></canvas>
            </div>
            <div id="container1">   <!-- Condicion -->  
                <canvas id="line-chart"></canvas>
            </div>
            <div id="container4">   <!-- Alajuela -->                  
                <canvas id="line-chart2"></canvas>
            </div>
            <div id="container3">   <!-- Cantones -->          
                <canvas id="bar-chart"></canvas>
            </div>
        </div>
        <div id="footer">
            <a id="linkSubir" href="#bienvenida">Subir</a>
            <p>COVID-19 en Costa Rica. Desarrollado por un no desarrollador<br>
                Los datos se obtienen a diario del <a target="_blank" href="https://www.ministeriodesalud.go.cr/index.php/centro-de-prensa/noticias/741-noticias-2020/1532-lineamientos-nacionales-para-la-vigilancia-de-la-infeccion-por-coronavirus-2019-ncov">Ministerio de Salud</a> 
            </p>
        </div>
    </body>

    <script>
//----------------

        var diasCondicion = ["Abril 1","Abril 3","Abril 5","Abril 7","Abril 9","Abril 11","Abril 13","Abril 15","Abril 17","Abril 19",
                             "Abril 21","Abril 23","Abril 25","Abril 27","Abril 29","Mayo 1","Mayo 3","Mayo 5","Mayo 7","Mayo 9","Mayo 11","Mayo 13","Mayo 15","Mayo 17","Mayo 19","Mayo 21",
                             "Mayo 23","Mayo 25"];


        var dataRecuperados =   [4,11,16,24,30,49,62,67,88,112,
                                150,196,242,287,329,355,386,413,445,480,517,527,542,565,577,592,
                                607,628];

        var dataSala =          [4,11,12,11,6, 5,6,5,5,5,
                                5,5,6,8,8,9,10,12,13,15,16,15,12,14,13,9,
                                11,13];

        var dataCI =            [9,13,14,14,13,13,14,11,10,10,
                                6,8,7,8,8,7,6,5,6,6,6,6,5,3,5,3,
                                4,2];
//----------------
        var dataDiario =        [28,19,19,16,37,19,17,8,7,5,
                                7,5,6,2,8,6,6,13,4,7,9,11,13,10,16,10,
                                7,21];

        var dataCasosActivos =  [369,403,436,457,506,525,547,555,557,543, 
                                513,485,445,404,384,364,347,336,314,294,277,281,293,289,295,301,
                                301,313];
//----------------
        var dataDiasAlajuela = ["Marzo 21","Marzo 25", "Marzo 29","Abril 2","Abril 6","Abril 10",
                                 "Abril 14", "Abril 18","Abril 22","Abril 26","Abril 30","Mayo 3",
                                 "Mayo 7","Mayo 11","Mayo 15","Mayo 19","Mayo 23","Mayo 25"];

        var dataCasosAlajuela =  [25,36,55,61,66,70,
                                  72,47,31,27,28,26,
                                  23,15,13,11,11,10]    
//----------------
        var dataCanton           =        ["Alajuela","Santa Jose","Santa Ana"];
        var dataCantonRecuperado =        [70, 67, 37]
        var dataCantonActivo     =        [11, 60, 6]        

// Grafico 1 > Casos diarios ---------------------------------------------------------------
        new Chart(document.getElementById("line-chart"), {
        type: 'line',
        data: {
            labels: diasCondicion,
            datasets: [
            { 
                data: dataRecuperados,
                label: "Recuperados",
                backgroundColor:"rgba(142, 195, 167,0.8)", // pinta dentro del circulo de legend (si solo es linear)
                borderColor: "rgba(142, 195, 167)", // pinta la linea
                fill: false, // sirve para no rellenar todo el espacio hacia abajo
                borderWidth:3,

            }, { 
                data: dataSala,
                label: "En sala",
                backgroundColor:"rgba(236, 209, 74,0.8)",
                borderColor: "rgba(236, 209, 74,1)",
                fill: false,
                borderWidth:3,

            }, { 
                data: dataCI,
                label: "Cuidados Intensivos",
                backgroundColor:"rgba(196, 88, 80,0.8)",
                borderColor: "rgb(196, 88, 80)",
                fill: false,
                borderWidth:3,

            }
            ]
        },
        options: {
            responsive: true,
            title: {
                display: true,
                text: 'Condicion y Situacion Clinica'
            },
            legend:{
                labels:{
                    usePointStyle: true,
              }
            },
            hover: {
                animationDuration: 0
            },
            animation: {
                duration: 0,
                onComplete: function () {
                    var ctx = this.chart.ctx;
                    ctx.font = Chart.helpers.fontString(Chart.defaults.global.defaultFontSize, 'normal', Chart.defaults.global.defaultFontFamily);
                    ctx.fillStyle = this.chart.config.options.defaultFontColor;
                    ctx.textAlign = 'center';
                    ctx.textBaseline = 'bottom';
                    this.data.datasets.forEach(function (dataset) {
                        // esta puesto en 1 para que no escriba desde el primer punto
                        for (var i = 1; i < dataset.data.length; i++) {
                                var model = dataset._meta[Object.keys(dataset._meta)[0]].data[i]._model;
                                ctx.fillText(dataset.data[i], model.x, model.y - 5);
                           
                        }
                    });
            }} 
        }
        });
// Grafico 2 > Casos activos ---------------------------------------------------------------

        new Chart(document.getElementById("linebar-chart"), {
            type: 'line',
            data: {
                labels: diasCondicion,                       
                datasets: [
                { 
                    yAxisID: "y-axis-2",
                    data: dataDiario,
                    type: 'line',
                    label: "Casos Diarios",
                    backgroundColor:"rgba(121, 118, 118, 0.3)",
                    borderColor: "rgb(121, 118, 118)",
                    borderWidth:2,
                    borderDash: [5,5],
                    fill: false,
                    order:1
                },
                { 
                    yAxisID: "y-axis-1",
                    data: dataCasosActivos,
                    label: "Casos Activos",
                    backgroundColor:"rgba(236, 209, 74, 0.1)",
                    borderColor: "rgb(236, 209, 74)",
                    fill: true,

                    borderWidth:2,
                    order:2
                }
                ]
            },
            options: {
                title: {
                    display: true,
                    text: 'Casos Activos en el pais'
                },
                legend:{
                    labels:{
                        usePointStyle: true,
                    }
                },
                scales: {
                    yAxes: [{
                        position: 'left',
                        id: 'y-axis-1',
                        ticks: {
                            max: 600,
                            min: 100,
                            stepSize: 100
                        },
                    }, {
                        position: 'right',
                        id: 'y-axis-2',
                        ticks: {
                            max: 40,
                            min: 0,
                            stepSize: 10
                        },
                    }]
                },
                hover: {
                    animationDuration: 0
                },
                animation: {
                    duration: 0,
                    onComplete: function () {
                        var ctx = this.chart.ctx;
                        ctx.font = Chart.helpers.fontString(Chart.defaults.global.defaultFontSize, 'normal', Chart.defaults.global.defaultFontFamily);
                        ctx.fillStyle = this.chart.config.options.defaultFontColor;
                        ctx.textAlign = 'center';
                        ctx.textBaseline = 'bottom';
                        this.data.datasets.forEach(function (dataset) {
                            for (var i = 0; i < dataset.data.length; i++) {
                                    var model = dataset._meta[Object.keys(dataset._meta)[0]].data[i]._model;
                                    ctx.fillText(dataset.data[i], model.x, model.y - 7);
                            
                            }
                        });
                }} 
            }
            });
// Grafico 3 > Cantones con mas recuperados ---------------------------------------------------------------

        new Chart(document.getElementById("bar-chart"), {
        type: 'horizontalBar',
        data: {
            labels: dataCanton,
            datasets: [{
                label:"Recuperados",
                backgroundColor:"rgba(127, 191, 63, 0.3)",
                borderColor:"rgb(127, 191, 63)",
                borderWidth:1,
                data: dataCantonRecuperado
            },
            {
                label:"Casos Activos: Mayo 1",
                backgroundColor:"rgba(63, 191, 191, 0.3)",
                borderColor:"rgb(63, 191, 191)",
                borderWidth:1,
                data: dataCantonActivo
            }
            ]
        },
        options:{
            title: {
                display: true,
                text: 'Cantones con mayor cantidad de recuperados'
            },
            scales:{
                xAxes:[{
                    ticks: {
                        max: 85,
                        min: 0,
                        stepSize: 10
                    },
                    type: 'linear',
                    color:"rgb(244, 244, 244,0.5)"
                }],
                yAxes:[{
                    gridLines: {
                        display: true,
                        color:"rgb(244, 244, 244,0.5)"
                    }
                }]
            },
            hover: {
                animationDuration: 0
            },
            animation: {
                duration: 0,
                onComplete: function () {
                    var ctx = this.chart.ctx;
                    ctx.font = Chart.helpers.fontString(Chart.defaults.global.defaultFontSize, 'normal', Chart.defaults.global.defaultFontFamily);
                    ctx.fillStyle = this.chart.config.options.defaultFontColor;
                    ctx.textAlign = 'center';
                    ctx.textBaseline = 'bottom';
                    this.data.datasets.forEach(function (dataset) {
                        for (var i = 0; i < dataset.data.length; i++) {
                                var model = dataset._meta[Object.keys(dataset._meta)[0]].data[i]._model;
                                ctx.fillText(dataset.data[i], model.x + 10, model.y +5);
                           
                        }
                    });
            }} 
        }
        });
// Grafico 4 > Alajuela ----------------------------------------------------------------------------------

new Chart(document.getElementById("line-chart2"), {
            type: 'line',
            data: {
                labels: dataDiasAlajuela,           
                datasets: [
                { 
                    yAxisID: "y-axis-1",
                    data: dataCasosAlajuela,
                    label: "Casos Activos",
                    backgroundColor:"rgba(196, 88, 80, 0.3)",
                    borderColor: "rgb(196, 88, 80)",
                    fill: true,
                    borderWidth:2,
                }
                ]
            },
            options: {
                title: {
                    display: true,
                    text: 'Alajuela - Casos Activos'
                },
                legend:{
                    labels:{
                        usePointStyle: true,
                    }
                },
                scales: {
                    yAxes: [{
                        position: 'left',
                        id: 'y-axis-1',
                        ticks: {
                            max: 100,
                            min: 0,
                            stepSize: 10
                        },
                    }]
                },
                hover: {
                    animationDuration: 0
                },
                animation: {
                    duration: 0,
                    onComplete: function () {
                        var ctx = this.chart.ctx;
                        ctx.font = Chart.helpers.fontString(Chart.defaults.global.defaultFontSize, 'normal', Chart.defaults.global.defaultFontFamily);
                        ctx.fillStyle = this.chart.config.options.defaultFontColor;
                        ctx.textAlign = 'center';
                        ctx.textBaseline = 'bottom';
                        this.data.datasets.forEach(function (dataset) {
                            for (var i = 0; i < dataset.data.length; i++) {
                                    var model = dataset._meta[Object.keys(dataset._meta)[0]].data[i]._model;
                                    ctx.fillText(dataset.data[i], model.x, model.y - 7);
                            
                            }
                        });
                }} 
            }
            });
// Grafico 5 > Recuperados VS Activos ---------------------------------------------------------------

new Chart(document.getElementById("line-chart3"), {
            type: 'line',
            data: {
                labels: diasCondicion,                       
                datasets: [
                { 
                    
                    data: dataRecuperados,
                    type: 'line',
                    label: "Recuperados",
                    backgroundColor:"rgba(127, 191, 63, 0.5)",
                    borderColor: "rgb(127, 191, 63)",
                    borderWidth:2,
                    fill: true,
                    order:1
                },
                { 
                   
                    data: dataCasosActivos,
                    label: "Casos Activos",
                    backgroundColor:"rgba(236, 209, 74, 0.2)",
                    borderColor: "rgb(236, 209, 74)",
                    fill: true,
                    borderWidth:2,
                    order:2
                }
                ]
            },
            options: {
                title: {
                    display: true,
                    text: 'Casos Activos VS Recuperados'
                },
                legend:{
                    labels:{
                        usePointStyle: true,
                    }
                },
                scales: {
                    yAxes: [{
                        position: 'left',
                        
                        ticks: {
                            max: 600,
                            min: 0,
                            stepSize: 100
                        },
                    }]
                },
                hover: {
                    animationDuration: 0
                },
                animation: {
                    duration: 0,
                    onComplete: function () {
                        var ctx = this.chart.ctx;
                        ctx.font = Chart.helpers.fontString(Chart.defaults.global.defaultFontSize, 'normal', Chart.defaults.global.defaultFontFamily);
                        ctx.fillStyle = this.chart.config.options.defaultFontColor;
                        ctx.textAlign = 'center';
                        ctx.textBaseline = 'bottom';
                        this.data.datasets.forEach(function (dataset) {
                            for (var i = 0; i < dataset.data.length; i++) {
                                    var model = dataset._meta[Object.keys(dataset._meta)[0]].data[i]._model;
                                    ctx.fillText(dataset.data[i], model.x, model.y - 7);
                            
                            }
                        });
                }} 
            }
            });
// JS ---------------------------------------
// JS ---------------------------------------
// JS ---------------------------------------
        $(document).ready(function(){
            $("#btnGraf1").click(function(){
                $("#container1").show();
                $("#container2").hide();
                $("#container3").hide();
                $("#container4").hide(); 
                $("#container5").hide();    
            });
            $("#btnGraf2").click(function(){
                $("#container2").show();
                $("#container1").hide();
                $("#container3").hide();
                $("#container4").hide();  
                $("#container5").hide();       
            });
            $("#btnGraf3").click(function(){
                $("#container3").show();
                $("#container1").hide();
                $("#container2").hide();  
                $("#container4").hide();
                $("#container5").hide();               
            });
            $("#btnGraf4").click(function(){
                $("#container4").show();         
                $("#container1").hide();
                $("#container2").hide();   
                $("#container3").hide(); 
                $("#container5").hide();            
            });
            $("#btnGraf5").click(function(){
                $("#container5").show();         
                $("#container1").hide();
                $("#container2").hide();   
                $("#container3").hide(); 
                $("#container4").hide();            
            });
            $("#btnGrafTodos").click(function(){
                $("#container1").show();
                $("#container2").show();  
                $("#container3").show();
                $("#container4").show();  
                $("#container5").show();            
            });  
        });
        if (window.location.href.indexOf('Alajuela') > -1) {
           setTimeout(function(){ $('#btnGraf4').click()}, 100);
        }
        if (window.location.href.indexOf('CasosActivos') > -1) {
           setTimeout(function(){ $('#btnGraf2').click()}, 100);
        }
        if (window.location.href.indexOf('Recuperados') > -1) {
           setTimeout(function(){ $('#btnGraf3').click()}, 100);
        }
        if (window.location.href.indexOf('VS') > -1) {
           setTimeout(function(){ $('#btnGraf5').click()}, 100);
        }
        
    </script>
 </html>